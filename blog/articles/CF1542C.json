{"title":"CF1542C Strange Function","file":"CF1542C.json","pic":"/bg/20.jpg","tag":["数论"],"priority":0,"source":"CF","link":[["LG","https://www.luogu.com.cn/problem/CF1542C"],["CF","http://codeforces.com/problemset/problem/1542/C"]],"pswd":false,"date":"2021-07-04 07:51","content":"## 题面翻译\n\n记 $f(i)$ 为最小的正整数数 $x$ 满足 $x$ 不是 $i$ 的因子。\n\n现给出正整数 $n$，请计算出 $\\sum_{i=1}^n f(i)$ 模 $10^9+7$ 的值。上述式子等价于 $f(1)+f(2)+\\cdots+f(n)$。\n\n本题含多组数据。令数据组数为 $t$，那么有 $1 \\leq t \\leq 10^4$，$1 \\leq n \\leq 10^{16}$\n\n## 题解\n枚举 $f(x)=i$ 的贡献。如果 $f(x)=i$ 则有：\n$$\n\\operatorname{lcm}(1,2,\\dots,i-1)|x,i\\not|x\n$$\n令 $tmp=\\operatorname{lcm}(1,2,\\dots,i-1)$，即 $\\begin{cases}tmp\\times k\\mod i\\ne 0\\\\ tmp\\times k\\le n\\end{cases}$\n若 $a=\\gcd(tmp,i),x=\\frac{tmp}a,y=\\frac ia$，就可以进一步转化\n$$\n\\begin{cases}\nx\\times k\\mod y\\ne 0\\Rightarrow y\\not| k\\\\\nx\\times k\\le \\lfloor\\frac na\\rfloor\n\\end{cases}\n$$\n于是就是贡献了 $\\lfloor\\frac n{a\\times x}\\rfloor-\\lfloor\\frac n{a\\times x\\times y}\\rfloor$ 次。\n## 代码\n```cpp\n// Problem: C. Strange Function\n// Contest: Codeforces - Codeforces Round #729 (Div. 2)\n// URL: https://codeforces.ml/contest/1542/problem/C\n// Memory Limit: 256 MB\n// Time Limit: 1000 ms\n//\n// Powered by CP Editor (https://cpeditor.org)\n \n#include <bits/stdc++.h>\nusing namespace std;\n#define int long long\nint t, n;\nconst int mod = 1e9 + 7;\nsigned main() {\n\tcin >> t;\n\twhile (t--) {\n\t\tcin >> n;\n\t\tint tmp = 1;\n\t\tint ans = 0;\n\t\tfor (int i = 2; tmp <= n; i++) {\n\t\t\t//tmp*k % i !=0\n\t\t\tint aa = __gcd(tmp, i);\n\t\t\tint x = tmp / aa, y = i / aa;\n\t\t\t//x*k % y!=0\n\t\t\tans += ((n/aa / x) - (n/aa / x / y)) % mod * i % mod;\n\t\t\tans %= mod;\n\t\t\t//printf(\"%d %d\\n\",i,((n / x) - (n / x / y)) % mod * i % mod);\n\t\t\ttmp *= i / __gcd(i, tmp);\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}\n```"}