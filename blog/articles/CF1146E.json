{"title":"CF1146E Hot is Cold","file":"CF1146E.json","pic":"/bg/145.jpg","tag":["线段树"],"priority":0,"source":"CF","link":[["LG","https://www.luogu.com.cn/problem/CF1146E"],["CF","http://codeforces.com/problemset/problem/1146/E"]],"pswd":false,"date":"2021-06-27 18:04","content":"## 题面翻译\n\n有一个数列，每次操作会给定 $x$ 和不等号，可以将 $>x$ 或 $<x$ 的所有数乘 $-1$。求最后的数列。\n\n\n## 题解\n\n考虑 $>$ ，然后同理\n\n- 如果 $x\\ge 0$，那么原来 $[x+1,MAX],[MIN,-x-1]$ 的都会变成负的\n- 如果 $x<0$，那么 $[x+1,-x-1]$ 的变反号，剩下的变成负的\n\n于是 $<$ 同理了\n\n## 代码\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=1e5+100;\nint n,q;int a[N];\nint rev[N<<3],cov[N<<3];\n#define lc (x<<1)\n#define rc (x<<1|1)\n#define mid (l+r>>1)\n#define Range -100004,100004\nvoid pushdown(int x){\n\tif(cov[x]!=0){\n\t\tcov[lc]=cov[x];rev[lc]=0;\n\t\tcov[rc]=cov[x];rev[rc]=0;\n\t\tcov[x]=0;\n\t}\n\tif(rev[x]){\n\t\trev[lc]^=1;\n\t\trev[rc]^=1;\n\t\trev[x]=0;\n\t}\n}\nvoid Cov(int x,int l,int r,int ql,int qr,int val){\n\tif(ql<=l&&r<=qr){\n\t\tcov[x]=val,rev[x]=0;return;\n\t}\n\tpushdown(x);\n\tif(ql<=mid)Cov(lc,l,mid,ql,qr,val);\n\tif(mid<qr)Cov(rc,mid+1,r,ql,qr,val);\n}\nvoid Rev(int x,int l,int r,int ql,int qr){\n\tif(ql<=l&&r<=qr)\n\t\treturn void(rev[x]^=1);\n\tpushdown(x);\n\tif(ql<=mid)Rev(lc,l,mid,ql,qr);\n\tif(mid<qr)Rev(rc,mid+1,r,ql,qr);\n}\nint qry(int x,int l,int r,int pos){\n\tif(l==r){\n\t\tint a;if(l<=0)a=-1;else a=1;\n\t\tif(cov[x]!=0)a=cov[x];\n\t\tif(rev[x])a*=-1;\n\t\treturn abs(l)*a;\n\t}\n\tpushdown(x);\n\tif(pos<=mid)return qry(lc,l,mid,pos);\n\treturn qry(rc,mid+1,r,pos);\n}\nsigned main(){\n\tscanf(\"%d%d\",&n,&q);\n\tfor(int i=1;i<=n;i++)scanf(\"%d\",&a[i]);\n\twhile(q--){\n\t\tchar c=getchar();while(c!='<'&&c!='>')c=getchar();\n\t\tint x;scanf(\"%d\",&x);\n\t\tif(c=='>'){\n\t\t\tif(x>=0){\n\t\t\t\tCov(1,Range,x+1,100001,-1);\n\t\t\t\tCov(1,Range,-100001,-x-1,-1);\n\t\t\t}else{\n\t\t\t\tRev(1,Range,x+1,-x-1);\n\t\t\t\tCov(1,Range,-x,100001,-1);\n\t\t\t\tCov(1,Range,-100001,x,-1);\n\t\t\t}\n\t\t}else{\n\t\t\tif(x<=0){\n\t\t\t\tCov(1,Range,-100001,x-1,1);\n\t\t\t\tCov(1,Range,-x+1,100001,1);\n\t\t\t}else{\n\t\t\t\tRev(1,Range,-x+1,x-1);\n\t\t\t\tCov(1,Range,x,100001,1);\n\t\t\t\tCov(1,Range,-100001,-x,1);\n\t\t\t}\n\t\t}\n\t}\n\t\tfor(int i=1;i<=n;i++)\n\t\t\tprintf(\"%d \",qry(1,Range,a[i]));\n}\n```"}